Experiment = rep(NA, 0),
Measurement = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
temp_data_2 <- filter(temp_data, time_point == i)
selectionCoefTmp <- data.frame(genotype = rep(NA, 38),
SelectionCoefficient = rep(NA, 38),
Experiment = rep(NA, 38),
Measurement = rep(NA, 38),
Time_Point = rep(NA, 38))
for (g in unique(temp_data$genotype)){
count <- 1
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
TempSelectionCoef <- (fm - fwt) / fwt
selectionCoefTmp[count, 1] <- g
selectionCoefTmp[count, 2] <- TempSelectionCoef
selectionCoefTmp[count, 3] <- temp_month
selectionCoefTmp[count, 4] <- temp_measurement
selectionCoefTmp[count, 5] <- i
count <- count + 1
}
selectionCoef <- rbind(selectionCoef, selectionCoefTmp)
}
selectionCoef
try_this <- na.omit(selectionCoef)
try_this
unique(try_this$genotype)
unique(temp_data$genotype)
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
temp_data_2 <- filter(temp_data, time_point == i)
top_count <- 1
for (g in unique(temp_data$genotype)){
count <- 1
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
TempSelectionCoef <- (fm - fwt) / fwt
selectionCoefTmp[count, 1] <- g
selectionCoefTmp[count, 2] <- TempSelectionCoef
selectionCoefTmp[count, 3] <- temp_month
selectionCoefTmp[count, 4] <- temp_measurement
selectionCoefTmp[count, 5] <- i
count <- (count + 1) * top_count
}
top_count <- top_count + 1
}
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
temp_data_2 <- filter(temp_data, time_point == i)
top_count <- 1
for (g in unique(temp_data$genotype)){
count <- 1
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
TempSelectionCoef <- (fm - fwt) / fwt
selectionCoef[count, 1] <- g
selectionCoef[count, 2] <- TempSelectionCoef
selectionCoef[count, 3] <- temp_month
selectionCoef[count, 4] <- temp_measurement
selectionCoef[count, 5] <- i
count <- (count + 1) * top_count
}
top_count <- top_count + 1
}
selectionCoef
temp_data_2
GM
gm
fm
fwt
temp_data
length(unique(temp_data$time_point))
temp_data
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0),
Time_Point = rep(NA, 0))
selectionCoef
selectionCoef[1]
selectionCoef[1] <- c(1,2,3,4,5)
selectionCoef[1, ] <- c(1,2,3,4,5)
selectionCoef
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0),
Time_Point = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
message(i)
temp_data_2 <- filter(temp_data, time_point == i)
for (g in unique(temp_data$genotype)){
message(g)
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
selectionCoef[count, 1] <- g
selectionCoef[count, 2] <- (fm - fwt) / fwt
selectionCoef[count, 3] <- temp_month
selectionCoef[count, 4] <- temp_measurement
selectionCoef[count, 5] <- i
count <- (count + 1) * top_count
}
top_count <- top_count + 1
}
selectionCoef
top_count
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0),
Time_Point = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
message(i)
temp_data_2 <- filter(temp_data, time_point == i)
top_count <- 1
for (g in unique(temp_data$genotype)){
message(g)
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
selectionCoef[count, 1] <- g
selectionCoef[count, 2] <- (fm - fwt) / fwt
selectionCoef[count, 3] <- temp_month
selectionCoef[count, 4] <- temp_measurement
selectionCoef[count, 5] <- i
count <- (count + 1) * top_count
message(count)
}
top_count <- top_count + 1
}
count
top_count
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0),
Time_Point = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
message(i)
temp_data_2 <- filter(temp_data, time_point == i)
top_count <- 1
count <- 1
for (g in unique(temp_data$genotype)){
message(g)
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
selectionCoef[count, 1] <- g
selectionCoef[count, 2] <- (fm - fwt) / fwt
selectionCoef[count, 3] <- temp_month
selectionCoef[count, 4] <- temp_measurement
selectionCoef[count, 5] <- i
count <- (count + 1) * top_count
message(count)
}
top_count <- top_count + 1
}
selectionCoef
count
top_count
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0),
Time_Point = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
message(i)
temp_data_2 <- filter(temp_data, time_point == i)
top_count <- top_count + 1
count <- 1
for (g in unique(temp_data$genotype)){
message(g)
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
selectionCoef[count, 1] <- g
selectionCoef[count, 2] <- (fm - fwt) / fwt
selectionCoef[count, 3] <- temp_month
selectionCoef[count, 4] <- temp_measurement
selectionCoef[count, 5] <- i
count <- (count + 1) * top_count
message(count)
}
top_count <- top_count + 1
}
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0),
Time_Point = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
message(i)
temp_data_2 <- filter(temp_data, time_point == i)
selectionCoefTmp <- data.frame(genotype = rep(NA, 38),
SelectionCoefficient = rep(NA, 38),
Experiment = rep(NA, 38),
Measurement = rep(NA, 38),
Time_Point = rep(NA, 38))
count <- 1
for (g in unique(temp_data$genotype)){
message(g)
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
selectionCoefTmp[count, 1] <- g
selectionCoefTmp[count, 2] <- (fm - fwt) / fwt
selectionCoefTmp[count, 3] <- temp_month
selectionCoefTmp[count, 4] <- temp_measurement
selectionCoefTmp[count, 5] <- i
count <- count + 1
message(count)
}
selectionCoef <- rbind(selectionCoef, selectionCoefTmp)
}
selectionCoef
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0),
Time_Point = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for(temp_month in c("Dec", "Jan", "Feb")){
for (temp_measurement in c("phi2", "npq", "leafarea")){
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
message(i)
temp_data_2 <- filter(temp_data, time_point == i)
selectionCoefTmp <- data.frame(genotype = rep(NA, 38),
SelectionCoefficient = rep(NA, 38),
Experiment = rep(NA, 38),
Measurement = rep(NA, 38),
Time_Point = rep(NA, 38))
count <- 1
for (g in unique(temp_data$genotype)){
message(g)
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
selectionCoefTmp[count, 1] <- g
selectionCoefTmp[count, 2] <- (fm - fwt) / fwt
selectionCoefTmp[count, 3] <- temp_month
selectionCoefTmp[count, 4] <- temp_measurement
selectionCoefTmp[count, 5] <- i
count <- count + 1
message(count)
}
selectionCoef <- rbind(selectionCoef, selectionCoefTmp)
}
}
}
selectionCoef
depi_data%>%group_by(month)%>%summarize(length(unique(genotype)))
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0),
Time_Point = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for(temp_month in c("Dec", "Jan", "Feb")){
for (temp_measurement in c("phi2", "npq", "leafarea")){
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
message(i)
temp_data_2 <- filter(temp_data, time_point == i)
selectionCoefTmp <- data.frame(genotype = rep(NA, 38),
SelectionCoefficient = rep(NA, 38),
Experiment = rep(NA, 38),
Measurement = rep(NA, 38),
Time_Point = rep(NA, 38))
count <- 1
for (g in unique(temp_data$genotype)){
message(g)
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
selectionCoefTmp[count, 1] <- g
selectionCoefTmp[count, 2] <- (fm - fwt) / fwt
selectionCoefTmp[count, 3] <- temp_month
selectionCoefTmp[count, 4] <- temp_measurement
selectionCoefTmp[count, 5] <- i
count <- count + 1
message(count)
}
selectionCoef <- rbind(selectionCoef, selectionCoefTmp)
}
}
}
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0),
Time_Point = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for(temp_month in c("Dec", "Jan", "Feb")){
for (temp_measurement in c("phi2", "npq", "leafarea")){
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for (i in unique(temp_data$time_point)){
temp_data_2 <- filter(temp_data, time_point == i)
selectionCoefTmp <- data.frame(genotype = rep(NA, 38),
SelectionCoefficient = rep(NA, 38),
Experiment = rep(NA, 38),
Measurement = rep(NA, 38),
Time_Point = rep(NA, 38))
count <- 1
for (g in unique(temp_data$genotype)){
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
selectionCoefTmp[count, 1] <- g
selectionCoefTmp[count, 2] <- (fm - fwt) / fwt
selectionCoefTmp[count, 3] <- temp_month
selectionCoefTmp[count, 4] <- temp_measurement
selectionCoefTmp[count, 5] <- i
count <- count + 1
}
selectionCoef <- rbind(selectionCoef, selectionCoefTmp)
}
}
}
selectionCoef<- data.frame(genotype = rep(NA, 0),
SelectionCoefficient = rep(NA, 0),
Experiment = rep(NA, 0),
Measurement = rep(NA, 0),
Time_Point = rep(NA, 0))
temp_month <- "Jan"
temp_measurement <- "phi2"
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
for(temp_month in c("Dec", "Jan", "Feb")){
for (temp_measurement in c("phi2", "npq", "leafarea")){
temp_data <- depi_data%>%
filter(month == temp_month, measurement == temp_measurement)
temp_n_row <- ifelse(temp_month == "Dec", 37, 38)
for (i in unique(temp_data$time_point)){
temp_data_2 <- filter(temp_data, time_point == i)
selectionCoefTmp <- data.frame(genotype = rep(NA, temp_n_row),
SelectionCoefficient = rep(NA, temp_n_row),
Experiment = rep(NA, temp_n_row),
Measurement = rep(NA, temp_n_row),
Time_Point = rep(NA, temp_n_row))
count <- 1
for (g in unique(temp_data$genotype)){
fm <- mean(filter(temp_data_2, genotype == g, month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
fwt <- mean(filter(temp_data_2, genotype == "Col0", month == temp_month, measurement == temp_measurement, time_point == i)$normalized_value)
selectionCoefTmp[count, 1] <- g
selectionCoefTmp[count, 2] <- (fm - fwt) / fwt
selectionCoefTmp[count, 3] <- temp_month
selectionCoefTmp[count, 4] <- temp_measurement
selectionCoefTmp[count, 5] <- i
count <- count + 1
}
selectionCoef <- rbind(selectionCoef, selectionCoefTmp)
}
}
}
selectionCoef
unique(selectionCoef$Time_Point)
m_test_1 <- filter(depi_data, month = "Dec", measurement = "phi2", time_point = "0", genotype = "mpk1")$normalized_value
wt_test_1 <- filter(depi_data, month = "Dec", measurement = "phi2", time_point = "0", genotype = "Col0")$normalized_value
mean((m_test_1 - wt_test_1) / wt_test_1)
m_test_1 <- filter(depi_data, month == "Dec", measurement == "phi2", time_point == "0", genotype == "mpk1")$normalized_value
wt_test_1 <- filter(depi_data, month == "Dec", measurement == "phi2", time_point == "0", genotype == "Col0")$normalized_value
mean((m_test_1 - wt_test_1) / wt_test_1)
colnames(selectionCoef)
filter(selectionCoef, Experiment == "Dec", Measurement == "phi2", Time_Point == "0", genotype == "mpk1")
m_test_1 <- mean(filter(depi_data, month == "Dec", measurement == "phi2", time_point == "0", genotype == "mpk1")$normalized_value)
wt_test_1 <- mean(filter(depi_data, month == "Dec", measurement == "phi2", time_point == "0", genotype == "Col0")$normalized_value)
((m_test_1 - wt_test_1) / wt_test_1)
m_test_1 <- mean(filter(depi_data, month == "Dec", measurement == "phi2", time_point == "0", genotype == "mpk1")$normalized_value)
wt_test_1 <- mean(filter(depi_data, month == "Dec", measurement == "phi2", time_point == "0", genotype == "Col0")$normalized_value)
((m_test_1 - wt_test_1) / wt_test_1)
filter(selectionCoef, Experiment == "Dec", Measurement == "phi2", Time_Point == "0", genotype == "mpk1")
colnames(selectionCoef)
summary(selectionCoef$SelectionCoefficient)
for (temp_month in c("Dec", "Jan", "Feb")){
for (temp_measurement in c("phi2", "npq", "leafarea")){
temp_plot_data <- filter(selectionCoef, Experiment == temp_month, Measurement == temp_measurement)
temp_title <- ifelse(temp_month == "Dec", "December", ifelse(temp_month == "Jan", "January", "February"))
temp_lower_bound <- round(min(temp_plot_data$SelectionCoefficient) - 0.05, 2)
temp_upper_bound <- round(max(temp_plot_data$SelectionCoefficient) + 0.05, 2)
plot <- ggplot(data = temp_plot_data, aes(x = Time_Point, y = genotype, fill = SelectionCoefficient)) +
labs(fill = "Selection Coefficients", x = "Hours", y = NULL, title = paste(temp_title, ":", m, "Selection Coefficient"))+
geom_tile(width = ifelse(m == "leafarea", 16, 10) , height = 30)+
facet_grid(genotype ~ day, scales = "free", switch = "y")+
theme_tufte(base_family = "Calibri",
base_size = 50)+
theme(strip.background.y = element_blank(),
strip.text.y = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
panel.spacing=unit(0, "lines"))+
scale_fill_gradient2(low = "blue", high="red", mid = "white", midpoint = 0, limits = c(temp_lower_bound, temp_upper_bound), breaks = c(temp_lower_bound, 0, temp_upper_bound), labels = c(as.character(temp_lower_bound), "0", as.character(temp_upper_bound)))
print(plot)
}
}
for (temp_month in c("Dec", "Jan", "Feb")){
for (temp_measurement in c("phi2", "npq", "leafarea")){
temp_plot_data <- filter(selectionCoef, Experiment == temp_month, Measurement == temp_measurement)
temp_title <- ifelse(temp_month == "Dec", "December", ifelse(temp_month == "Jan", "January", "February"))
temp_lower_bound <- round(min(temp_plot_data$SelectionCoefficient) - 0.05, 2)
temp_upper_bound <- round(max(temp_plot_data$SelectionCoefficient) + 0.05, 2)
plot <- ggplot(data = temp_plot_data, aes(x = Time_Point, y = genotype, fill = SelectionCoefficient)) +
labs(fill = "Selection Coefficients", x = "Hours", y = NULL, title = paste(temp_title, ":", temp_measurement, "Selection Coefficient"))+
geom_tile(width = ifelse(m == "leafarea", 16, 10) , height = 30)+
facet_grid(genotype ~ day, scales = "free", switch = "y")+
theme_tufte(base_family = "Calibri",
base_size = 50)+
theme(strip.background.y = element_blank(),
strip.text.y = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
panel.spacing=unit(0, "lines"))+
scale_fill_gradient2(low = "blue", high="red", mid = "white", midpoint = 0, limits = c(temp_lower_bound, temp_upper_bound), breaks = c(temp_lower_bound, 0, temp_upper_bound), labels = c(as.character(temp_lower_bound), "0", as.character(temp_upper_bound)))
print(plot)
}
}
for (temp_month in c("Dec", "Jan", "Feb")){
for (temp_measurement in c("phi2", "npq", "leafarea")){
temp_plot_data <- filter(selectionCoef, Experiment == temp_month, Measurement == temp_measurement)
temp_title <- ifelse(temp_month == "Dec", "December", ifelse(temp_month == "Jan", "January", "February"))
temp_lower_bound <- round(min(temp_plot_data$SelectionCoefficient) - 0.05, 2)
temp_upper_bound <- round(max(temp_plot_data$SelectionCoefficient) + 0.05, 2)
plot <- ggplot(data = temp_plot_data, aes(x = Time_Point, y = genotype, fill = SelectionCoefficient)) +
labs(fill = "Selection Coefficients", x = "Hours", y = NULL, title = paste(temp_title, ":", temp_measurement, "Selection Coefficient"))+
geom_tile(width = ifelse(temp_measurement == "leafarea", 16, 10) , height = 30)+
facet_grid(genotype ~ day, scales = "free", switch = "y")+
theme_tufte(base_family = "Calibri",
base_size = 50)+
theme(strip.background.y = element_blank(),
strip.text.y = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
panel.spacing=unit(0, "lines"))+
scale_fill_gradient2(low = "blue", high="red", mid = "white", midpoint = 0, limits = c(temp_lower_bound, temp_upper_bound), breaks = c(temp_lower_bound, 0, temp_upper_bound), labels = c(as.character(temp_lower_bound), "0", as.character(temp_upper_bound)))
print(plot)
}
}
selectionCoef <- add_day_col(selectionCoef)
for (temp_month in c("Dec", "Jan", "Feb")){
for (temp_measurement in c("phi2", "npq", "leafarea")){
temp_plot_data <- filter(selectionCoef, Experiment == temp_month, Measurement == temp_measurement)
temp_title <- ifelse(temp_month == "Dec", "December", ifelse(temp_month == "Jan", "January", "February"))
temp_lower_bound <- round(min(temp_plot_data$SelectionCoefficient) - 0.05, 2)
temp_upper_bound <- round(max(temp_plot_data$SelectionCoefficient) + 0.05, 2)
plot <- ggplot(data = temp_plot_data, aes(x = Time_Point, y = genotype, fill = SelectionCoefficient)) +
labs(fill = "Selection Coefficients", x = "Hours", y = NULL, title = paste(temp_title, ":", temp_measurement, "Selection Coefficient"))+
geom_tile(width = ifelse(temp_measurement == "leafarea", 16, 10) , height = 30)+
facet_grid(genotype ~ day, scales = "free", switch = "y")+
theme_tufte(base_family = "Calibri",
base_size = 50)+
theme(strip.background.y = element_blank(),
strip.text.y = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
panel.spacing=unit(0, "lines"))+
scale_fill_gradient2(low = "blue", high="red", mid = "white", midpoint = 0, limits = c(temp_lower_bound, temp_upper_bound), breaks = c(temp_lower_bound, 0, temp_upper_bound), labels = c(as.character(temp_lower_bound), "0", as.character(temp_upper_bound)))
print(plot)
}
}
filter(selectionCoef, measurement == "leafarea", Experiment == "Jan")
filter(selectionCoef, Measurement == "leafarea", Experiment == "Jan")
unique(filter(selectionCoef, Measurement == "leafarea", Experiment == "Jan")$day)
unique(filter(selectionCoef, Measurement == "phi2", Experiment == "Jan")$day)
filter(depi_data, month == "Jan", measurement == "leafarea")
unique(filter(depi_data, month == "Jan", measurement == "leafarea")$time_point)
