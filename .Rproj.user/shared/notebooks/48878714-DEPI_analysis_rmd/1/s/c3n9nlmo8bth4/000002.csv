"0","corrected_p_value <- function(data_frame){"
"0","  out <- data_frame%>%"
"0","  ###For some reason, I have multiple copies of each row"
"0","  distinct()%>%"
"0","  ###Group by time point and measurement - we are correcting by the number of genotypes "
"0","  group_by(time_point, measurement)%>%"
"0","  mutate(p_adj = p.adjust(p, method = ""fdr""))%>%"
"0","  ###Effect size calculated using method from:"
"0","  ###https://stats.stackexchange.com/questions/133077/effect-size-to-wilcoxon-signed-rank-test"
"0","  "
"0","  ###Only report an effect size if the p-value is significant; otherwise, NA"
"0","  mutate(effect = ifelse(p < 0.05, (abs(qnorm(p_adj))/sqrt(n_wt+n_genotype)), NA))%>%"
"0","  mutate(effect_size = case_when("
"0","    ###Make sure these are the right cut offs for magnitude of effect size"
"0","    (effect <0.1)~""small"","
"0","    (effect>0.1 & effect < 0.5)~""medium"","
"0","    (effect>0.5)~""large""))"
"0","  ###Gather the data to make it easier to plot according to whether p was adjusted"
"0","  out <- gather(out, type, p, p, p_adj)%>%arrange(genotype, time_point)"
"0","  return(out) "
"0","}"
