"0","add_day_col <- function(data_frame){"
"0","  unique_time <- sort(unique(data_frame$time_point))"
"0","  diff <- c()"
"0","  for (i in 1:length(unique_time)){"
"0","   if (i == 1){"
"0","      diff[1] <- 0"
"0","   }else{"
"0","      diff[i] <- unique_time[i] - unique_time[i-1]}}"
"0","  breaks <-c(0)"
"0","  for (i in 1:length(diff)){"
"0","    if (diff[i] > 5)"
"0","      breaks <- append(breaks, unique_time[i])}"
"0","  out <- data.frame()"
"0","  for (i in 1:length(breaks)){"
"0","    if (i == length(breaks)){"
"0","      indiv <- data_frame%>%filter(time_point >= breaks[i])%>%mutate(day = i)"
"0","   }else{"
"0","    indiv <- data_frame%>%filter(time_point >=breaks[i] & time_point < breaks[i+1])%>%mutate(day = i)}"
"0","    "
"0","    out <- rbind(as.data.frame(indiv), out)}"
"0","  return(out)}"
